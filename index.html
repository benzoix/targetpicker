<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover">
  <title>My LIFF app</title>
  <link rel="stylesheet" href="css/style.css" media="all">
</head>
<body>
  <p id="os"><b>OS:</b> </p>
  <p id="language"><b>Language:</b> </p>
  <p id="version"><b>Version:</b> </p>
  <p id="isInClient"><b>isInClient:</b> </p>
  <p id="accessToken"><b>AccessToken:</b> </p>
  <img id="pictureUrl">
  <p id="userId"><b>userId:</b> </p>
  <p id="displayName"><b>displayName:</b> </p>
  <p id="statusMessage"><b>statusMessage:</b> </p>
  <p id="decodedIDToken"><b>email:</b> </p>
  <p id="type"><b>type:</b> </p>
  <p id="viewType"><b>viewType:</b> </p>
  <p id="utouId"><b>utouId:</b> </p>
  <p id="roomId"><b>roomId:</b> </p>
  <p id="groupId"><b>groupId:</b> </p>
  <p id="friendship"><b>isFriendship:</b> </p>
  <p id="scanCode"><b>Code:</b> </p>
  <p id="isLoggedIn"><b>isLoggedIn:</b> </p>
  <p id="universalLink1"><b>Universal Link:</b> </p>
  <p id="universalLink2"><b>Universal Link with Query params:</b> </p>
  <p><a href="liff/path/?param=9">Link to Path</a></p>

  <button id="btnMsg" onclick="sendMsg()">Send Message</button>
  <button id="btnShare" onclick="shareMsg()">Share Target Picker</button>
  <button onclick="openWindow()">Open Window</button>
  <button id="btnScanCode" onclick="scanCode()">Scan Code</button>
  <button id="btnLogOut" onclick="logOut()">Log Out</button>
  <button id="btnClose" onclick="closed()">Close</button>

  <!-- <script src="js/vconsole.min.js"></script> -->
  <!-- <script>
    var vConsole = new VConsole()
    console.log("Hello World!")
  </script> -->

  <script src="https://static.line-scdn.net/liff/edge/versions/2.8.0/sdk.js"></script>
  <script>
    function createUniversalLink() {
    }

    async function shareMsg() {
      const result = await liff.shareTargetPicker([{ 
        "type": "flex",
        "altText": "this is a flex message",
        "contents": {
          "type": "bubble",
          "header": {
            "type": "box",
            "layout": "horizontal",
            "contents": [
              {
                "type": "box",
                "layout": "horizontal",
                "contents": [
                  {
                    "type": "image",
                    "url": "https://cf.shopee.co.th/file/bb1b18c453d02ec874691c906ebc60e3_tn",
                    "align": "start",
                    "flex": 1
                  }
                ],
                "width": "48px",
                "height": "48px",
                "margin": "none",
                "alignItems": "flex-start",
                "justifyContent": "flex-start"
              },
              {
                "type": "box",
                "layout": "vertical",
                "contents": [
                  {
                    "type": "text",
                    "text": "Riley_Shoes",
                    "size": "20px",
                    "weight": "bold",
                    "style": "normal"
                  },
                  {
                    "type": "text",
                    "text": "Go to Shop",
                    "size": "sm"
                  }
                ],
                "offsetStart": "12px",
                "offsetTop": "4px",
                "paddingEnd": "20px"
              }
            ],
            "position": "relative",
            "alignItems": "flex-start",
            "margin": "none",
            "paddingAll": "20px"
          },
          "body": {
            "type": "box",
            "layout": "vertical",
            "contents": [
              {
                "type": "box",
                "layout": "horizontal",
                "contents": [
                  {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                      {
                        "type": "image",
                        "url": "https://cf.shopee.sg/file/73416b5dbf57f2840ea016bf4be1fbca",
                        "size": "full"
                      }
                    ],
                    "cornerRadius": "4px",
                    "spacing": "none",
                    "width": "64px",
                    "height": "64px"
                  },
                  {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                      {
                        "type": "text",
                        "text": "Woven Slide Sandals",
                        "wrap": true
                      },
                      {
                        "type": "text",
                        "text": "฿1,140 - ฿1,340",
                        "weight": "bold",
                        "color": "#FF3B30"
                      },
                      {
                        "type": "text",
                        "text": "฿1,240 - ฿1,440",
                        "size": "sm",
                        "color": "#AAAAAA",
                        "decoration": "line-through"
                      },
                      {
                        "type": "text",
                        "text": "2 item left",
                        "size": "xs",
                        "offsetTop": "none"
                      }
                    ],
                    "alignItems": "flex-start",
                    "paddingStart": "12px"
                  }
                ],
                "paddingBottom": "12px",
                "cornerRadius": "none"
              },
              {
                "type": "separator"
              },
              {
                "type": "box",
                "layout": "horizontal",
                "contents": [
                  {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                      {
                        "type": "image",
                        "url": "https://cf.shopee.sg/file/c5be59470e6ba4ceee69c03fd5dcdb62",
                        "size": "full"
                      }
                    ],
                    "cornerRadius": "4px",
                    "spacing": "none",
                    "width": "64px",
                    "height": "64px"
                  },
                  {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                      {
                        "type": "text",
                        "text": "MONMOIRA Weaving N…",
                        "wrap": true
                      },
                      {
                        "type": "text",
                        "text": "฿1,140",
                        "weight": "bold",
                        "color": "#000000"
                      },
                      {
                        "type": "box",
                        "layout": "baseline",
                        "contents": [
                          {
                            "type": "icon",
                            "url": "https://img.icons8.com/pastel-glyph/64/26e07f/parking--v3.png",
                            "size": "sm",
                            "aspectRatio": "1:1",
                            "offsetTop": "xs"
                          },
                          {
                            "type": "text",
                            "text": "500 Points back",
                            "size": "xs",
                            "color": "#000000",
                            "margin": "sm",
                            "gravity": "center"
                          }
                        ]
                      }
                    ],
                    "offsetStart": "none",
                    "paddingStart": "12px"
                  }
                ],
                "paddingBottom": "12px",
                "paddingTop": "12px"
              },
              {
                "type": "separator",
                "margin": "none"
              },
              {
                "type": "box",
                "layout": "horizontal",
                "contents": [
                  {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                      {
                        "type": "image",
                        "url": "https://cf.shopee.sg/file/6bdfed4f68b0db066a497eeb18128f28",
                        "size": "full"
                      }
                    ],
                    "cornerRadius": "4px",
                    "spacing": "none",
                    "width": "64px",
                    "height": "64px"
                  },
                  {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                      {
                        "type": "text",
                        "text": "Leather Copper Head B...",
                        "wrap": true
                      },
                      {
                        "type": "box",
                        "layout": "baseline",
                        "contents": [
                          {
                            "type": "text",
                            "text": "฿1,140",
                            "weight": "bold",
                            "color": "#FF3B30",
                            "offsetStart": "none",
                            "flex": 2
                          },
                          {
                            "type": "text",
                            "text": "฿1,240",
                            "size": "sm",
                            "offsetStart": "none",
                            "color": "#AAAAAA",
                            "decoration": "line-through",
                            "margin": "none",
                            "flex": 5
                          }
                        ]
                      },
                      {
                        "type": "text",
                        "text": "50% discount",
                        "size": "xs",
                        "color": "#000000"
                      }
                    ],
                    "paddingStart": "12px"
                  }
                ],
                "paddingTop": "lg",
                "paddingBottom": "lg"
              },
              {
                "type": "separator",
                "margin": "none"
              },
              {
                "type": "box",
                "layout": "horizontal",
                "contents": [
                  {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                      {
                        "type": "image",
                        "url": "https://cf.shopee.sg/file/c5be59470e6ba4ceee69c03fd5dcdb62",
                        "size": "full"
                      }
                    ],
                    "cornerRadius": "4px",
                    "spacing": "none",
                    "width": "64px",
                    "height": "64px"
                  },
                  {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                      {
                        "type": "text",
                        "text": "MONMOIRA Weaving N…",
                        "wrap": true
                      },
                      {
                        "type": "text",
                        "text": "฿1,140",
                        "weight": "bold",
                        "color": "#000000"
                      }
                    ],
                    "flex": 3,
                    "offsetStart": "md"
                  }
                ],
                "paddingBottom": "none",
                "paddingTop": "lg"
              }
            ],
            "margin": "none"
          },
          "footer": {
            "type": "box",
            "layout": "vertical",
            "contents": [
              {
                "type": "button",
                "action": {
                  "type": "uri",
                  "label": "Share all products",
                  "uri": "http://linecorp.com/"
                },
                "style": "link",
                "color": "#3C41FF"
              }
            ],
            "paddingAll": "20px"
          }
        }
      }
      ])
      if (result) {
        alert(`[${result.status}] Message sent!`)
      } else {
        const [majorVer, minorVer, patchVer] = (liff.getLineVersion() || "").split('.');

        if (minorVer === undefined) {
          alert('ShareTargetPicker was canceled in external browser')
          return
        }

        if (parseInt(majorVer) >= 10 && parseInt(minorVer) >= 10 && parseInt(patchVer) > 0) {
          alert('ShareTargetPicker was canceled in LINE app')
        }
      }
    }
    function logOut() {
    }

    function closed() {
    }

    async function scanCode() {
    }

    function openWindow() {
    }

    async function getFriendship() {
    }

    async function sendMsg() {
        if (liff.getContext().type !== "none") {
          await liff.sendMessages([
            {
              "type": "sticker",
              "stickerId": 1,
              "packageId": 1
            }
          ])
          alert("Message sent")
        }
    }

    function getContext() {
    }

    async function getUserProfile() {
      const profile = await liff.getProfile()
      document.getElementById("pictureUrl").src = profile.pictureUrl
      document.getElementById("userId").append(profile.userId)
      document.getElementById("statusMessage").append(profile.statusMessage)
      document.getElementById("displayName").append(profile.displayName)
      document.getElementById("decodedIDToken").append(liff.getDecodedIDToken().email)
    }

    function getEnvironment() {
      document.getElementById("os").append(liff.getOS())
      document.getElementById("language").append(liff.getLanguage())
      document.getElementById("version").append(liff.getVersion())
      document.getElementById("accessToken").append(liff.getAccessToken())
      document.getElementById("isInClient").append(liff.isInClient())
      if (liff.isInClient()) {
        document.getElementById("btnLogOut").style.display = "none"
      } else {
        document.getElementById("btnMsg").style.display = "none"
        document.getElementById("btnScanCode").style.display = "none"
        document.getElementById("btnClose").style.display = "none"
      }
    }
    async function main() {
      liff.ready.then(() => {
        document.getElementById("isLoggedIn").append(liff.isLoggedIn())
        if (liff.isLoggedIn()) {
          getEnvironment()
          getUserProfile()
          getContext()
          getFriendship()
          createUniversalLink()
          shareMsg()
        } else {
          liff.login()
        }
      })
      await liff.init({ liffId: "1655757832-DOkgB86O" })
      // getEnvironment()
      // getUserProfile()
      // getContext()
      // getFriendship()
      // createUniversalLink()
    }
    main()
  </script>
</body>
</html>
